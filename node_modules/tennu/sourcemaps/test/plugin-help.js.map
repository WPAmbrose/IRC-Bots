{"version":3,"sources":["/home/havvy/tennu/tennu/src/test/plugin-help.sjs"],"names":["sinon","require","assert","equal","inspect","format","install","debug","logfn","console","log","bind","HelpPlugin","pluginHelps","a","b","b1","b2","b3","c","c1","d","e","f","client","config","value","undefined","Error","describe","instance","help","HELP_NOT_FOUND","beforeEach","init","exports","hooks","it"],"mappings":"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","file":"plugin-help.js","sourcesContent":["const sinon = require(\"sinon\");\nconst assert = require(\"better-assert\");\nconst equal = require(\"deep-eql\");\nconst inspect = require(\"util\").inspect;\nconst format = require(\"util\").format;\nrequire(\"source-map-support\").install();\n\nconst debug = false;\nconst logfn = debug ? console.log.bind(console) : function () {};\n\nconst HelpPlugin = require(\"../tennu_plugins/help\");\n\nconst pluginHelps = {\n    a: \"a *\",\n    b: {\n        b: {\n            \"*\": \"b *\",\n            b1: \"b 1\",\n            b2: [\"b 2_1\", \"b 2_2\"],\n            b3: {\n                \"*\": \"b 3 *\"\n            },\n        },\n    },\n    c: {\n        c1: \"c 1\"\n    },\n    d: [\"d *_1\", \"d *_2\"],\n    e: \"{{!}}e\",\n    f: [\"{{!}}\", \"{{!}}\"]\n};\n\nconst client = {\n    config: function (value) {\n        if (value === \"disable-help\") {\n            return false;\n        }\n\n        if (value === \"command-trigger\") {\n            return \"@\";\n        }\n\n        if (value === \"help-helpfile\") {\n            return undefined;\n        }\n\n        throw new Error(format(\"Error in testing: Plugin expects config value (%s) we don't have.\", value));\n    }\n};\n\ndescribe \"Help plugin\" {\n    var instance, help, HELP_NOT_FOUND;\n\n    beforeEach {\n        logfn(/* newline */);\n\n        instance = HelpPlugin.init(client, {});\n        HELP_NOT_FOUND = instance.exports.HELP_NOT_FOUND;\n\n        instance.hooks.help(\"a\", pluginHelps.a);\n        instance.hooks.help(\"b\", pluginHelps.b);\n        instance.hooks.help(\"c\", pluginHelps.c);\n        instance.hooks.help(\"d\", pluginHelps.d);\n        instance.hooks.help(\"e\", pluginHelps.e);\n        instance.hooks.help(\"f\", pluginHelps.f);\n\n        help = instance.exports.help;\n    }\n\n    it \"returns HELP_NOT_FOUND for unknown topics\" {\n        assert(help([\"dnd\"]) === HELP_NOT_FOUND);\n    }\n\n    it \"returns HELP_NOT_FOUND for subtopics of unknown topics\" {\n        assert(help([\"dne\", \"subtopic\"]) === HELP_NOT_FOUND);\n    }\n\n    it \"assigns the topic of the plugin name the value of the string when given a string\" {\n        logfn(inspect(help([\"a\"])));\n        assert(help([\"a\"]) === \"a *\");\n    }\n\n    it \"assigns the topic of the plugin name the value of the array when given an array\" {\n        logfn(inspect(help([\"d\"])));\n        assert(equal(help([\"d\"]), [\"d *_1\", \"d *_2\"]));\n    }\n\n    it \"gives the * property of topics with an object value\" {\n        assert(help([\"b\"]) === \"b *\");\n    }\n\n    it \"gives HELP_NOT_FOUND for topics with an object value without the * property\" {\n        assert(help([\"c\"]) === HELP_NOT_FOUND);\n    }\n\n    it \"gives the subtopic string value for subtopic type of string\" {\n        logfn(inspect(help([\"b\", \"b1\"])));\n        assert(help([\"b\", \"b1\"]) === \"b 1\");\n    }\n\n    it \"gives the subtopic array value for subtopic type of array\" {\n        logfn(inspect(help([\"b\", \"b2\"])));\n        assert(equal(help([\"b\", \"b2\"]), [\"b 2_1\", \"b 2_2\"]));\n    }\n\n    it \"gives the * property of subtopic type of object\" {\n        logfn(inspect(help([\"b\", \"b3\"])));\n        assert(help([\"b\", \"b3\"]) === \"b 3 *\");\n    }\n\n    it \"gives HELP_NOT_FOUND for nonexistent subtopic of existing topic\" {\n        logfn(inspect(help([\"b\", \"b4\"])));\n        assert(help([\"b\", \"b4\"]) === HELP_NOT_FOUND);\n    }\n\n    it \"replaces {{!}} with the command trigger (string)\" {\n        logfn(inspect(help([\"e\"])));\n\n        assert(help([\"e\"]) === \"@e\");\n    }\n\n    it \"replaces {{!}} with the command trigger (array)\" {\n        assert(equal(help([\"f\"]), [\"@\", \"@\"]));\n    }\n}\n"],"sourceRoot":"/source/"}