{"version":3,"sources":["/home/havvy/tennu/tennu/src/lib/client.sjs"],"names":["lodash","require","packagejson","defaultFactoryConfiguration","Socket","defaultClientConfiguration","undefined","Client","config","dependencies","nick","user","Error","client","Object","create","prototype","_config","freeze","defaults","di","_logger","Logger","_socket","IrcSocket","NetSocket","_messageHandler","MessageHandler","_nickname","NicknameTracker","nickname","commandHandler","CommandHandler","_subscriber","BiSubscriber","on","privmsg","parse","_plugins","Plugins","addHook","module$2","handlers","note","use","__dirname","plugins","process","cwd","_actionExports","getPlugin","events","connected","param","connect","debug","warn","start","disconnect","end","act","apply","arguments","ctcp","join","kick","mode","notice","part","quit","say","userhost","who","whois","raw","rawf","once","off","getModule","getRole","initializePlugin","initialize","isPluginInitializable","isInitializable","info","error","crit","alert","emerg","log","level","args","Array","slice","call","module","exports"],"mappings":"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","file":"client.js","sourcesContent":["const lodash = require(\"lodash\");\nconst packagejson = require(\"../package.json\")[\"\"]\n\n// delegate x y -> function () { this.x.y.apply(this.x, arguments); return this; }\nmacro delegate {\n    rule { $property:ident $method:ident } => {\n        function () {\n            this . $property . $method . apply (this . $property , arguments);\n            return this;\n        }\n    }\n}\n\n// delegate_ret x y -> function () { return this.x.y.apply(this.x, arguments); }\nmacro delegate_ret {\n    rule { $property:ident $method:ident } => {\n        function () {\n            return this . $property . $method . apply (this . $property, arguments);\n        }\n    }\n}\n\nconst defaultFactoryConfiguration = {\n    \"NetSocket\" : require(\"net\").Socket,\n    \"IrcSocket\" : require(\"irc-socket\"),\n    \"MessageHandler\" : require(\"./message-handler.js\"),\n    \"CommandHandler\" : require(\"./command-handler.js\"),\n    \"Plugins\" : require(\"tennu-plugins\"),\n    \"BiSubscriber\" : require(\"./bisubscriber.js\"),\n    \"Logger\": require(\"./null-logger.js\"),\n    \"NicknameTracker\": require(\"./nickname-tracker.js\")\n};\n\nconst defaultClientConfiguration = {\n    // IrcSocket Config\n    \"server\": undefined,\n    \"port\": 6667,\n    \"ipv6\": undefined,\n    \"localAddress\": undefined,\n    \"secure\": false,\n    \"password\": undefined,\n    \"capab\": false,\n    \"nickname\": \"tennubot\",\n    \"username\": \"tennu\",\n    \"realname\": \"tennu \" + require(\"../package.json\")[\"version\"],\n\n    // Tennu Config\n    \"channels\": [],\n    \"nickserv\": \"nickserv\",\n    \"auth-password\": undefined,\n    \"plugins\": [],\n    \"command-trigger\": \"!\",\n    \"disable-help\": false\n};\n\n/** Fields\n * _config\n * _socket\n * _logger\n * events   (_subscriber)\n * plugins  (_plugins)\n * nickname (_nickname)\n */\n const Client = function (config, dependencies) {\n    if (config.nick || config.user) {\n        throw new Error(\"Please use \\\"nickname\\\" and \\\"username\\\" instead of \\\"nick\\\" and \\\"user\\\" in your configuration.\");\n    }\n\n    const client = Object.create(Client.prototype);\n\n    // Parse the configuration object. Make it immutable.\n    client._config = config = Object.freeze(lodash.defaults({}, config, defaultClientConfiguration));\n    di = lodash.defaults({}, dependencies || {}, defaultFactoryConfiguration);\n\n    // Create a logger.\n    // Default logger is a bunch of NOOPs.\n    client._logger = new di.Logger();\n\n    // The socket reads and sends messages from/to the IRC server.\n    client._socket = new di.IrcSocket(config, di.NetSocket);\n\n    // Create the listener to the socket.\n    // This listener will parse the raw messages of the socket, and\n    // emits specific events to listen to.\n    client._messageHandler = new di.MessageHandler(client, client._logger, client._socket);\n\n    // Create the object that tracks the nickname of the client.\n    // Because this object is a function, it is expected that\n    // the factory function does not use `this`.\n    client._nickname = di.NicknameTracker(config.nickname, client._messageHandler);\n\n    // Create the listener to private messages from the IRCMessageEmitter\n    // The commander will parse these private messages for commands, and\n    // emit those commands, also parsed.\n    const commandHandler = new di.CommandHandler(config, client, client._nickname, client._logger);\n\n    // The subscriber handles event subscriptions to the Client object,\n    // determining whether they should be handled by the IrcMessageEmitter\n    // or the Command Handler.\n    client._subscriber = new di.BiSubscriber(client._messageHandler, commandHandler);\n    client._subscriber.on(\"privmsg\", function (privmsg) { commandHandler.parse(privmsg); });\n\n    // Configure the plugin system.\n    client._plugins = new di.Plugins(\"tennu\", client);\n    client._plugins.addHook(\"handlers\", function (module, handlers) {\n        client._subscriber.on(handlers);\n    });\n    client.note(\"Tennu\", \"Loading default plugins\");\n    client._plugins.use([\"server\", \"action\", \"help\", \"user\", \"channel\", \"startup\"], __dirname);\n    client.note(\"Tennu\", \"Loading your plugins\");\n    client._plugins.use(config.plugins || [], process.cwd());\n\n    // Grab a reference to the \"action\" plugin exports, so that the client\n    // can delegate the actions to it.\n    client._actionExports = client.getPlugin(\"action\");\n\n    client.events = client._subscriber;\n    client.plugins = client._plugins;\n    client.nickname = client._nickname;\n\n    client.connected = false;\n\n    client.note(\"Tennu\", \"Client created.\");\n    return client;\n};\n\n// implements ConfigurationStorage\n\nClient.prototype.config = function (param) {\n    return this._config[param];\n};\n\n// implements Runnable ;)\n\nconst connect = function () {\n    this.debug(\"Tennu\", \"Trying to connect.\");\n\n    if (this.connected) {\n        this.warn(\"Tennu\", \"Attempted to start Tennu Client that already is connected.\");\n        return;\n    }\n\n    this._socket.connect();\n    this.connected = true;\n    this.debug(\"Tennu\", \"Connected\");\n    return this;\n}\n\nClient.prototype.connect = connect;\nClient.prototype.start = connect;\n\nconst disconnect = function () {\n    this.debug(\"Tennu\", \"Trying to disconnect.\");\n\n    if (!this.connected) {\n        this.warn(\"Tennu\", \"Attempted to end Tennu Client that already is not connected.\");\n        return this;\n    }\n\n    this._socket.end();\n    this.connected = false;\n    this.debug(\"Tennu\", \"Disconnected\");\n    return this;\n};\n\nClient.prototype.disconnect = disconnect;\nClient.prototype.end = disconnect;\n\n// implements IRC Output Socket\nClient.prototype.act                    = delegate_ret _actionExports act;\nClient.prototype.ctcp                   = delegate_ret _actionExports ctcp;\nClient.prototype.join                   = delegate_ret _actionExports join;\nClient.prototype.kick                   = delegate_ret _actionExports kick;\nClient.prototype.mode                   = delegate_ret _actionExports mode;\nClient.prototype.nick                   = delegate_ret _actionExports nick;\nClient.prototype.notice                 = delegate_ret _actionExports notice;\nClient.prototype.part                   = delegate_ret _actionExports part;\nClient.prototype.quit                   = delegate_ret _actionExports quit;\nClient.prototype.say                    = delegate_ret _actionExports say;\nClient.prototype.userhost               = delegate_ret _actionExports userhost;\nClient.prototype.who                    = delegate_ret _actionExports who;\nClient.prototype.whois                  = delegate_ret _actionExports whois;\nClient.prototype.raw                    = delegate_ret _actionExports raw;\nClient.prototype.rawf                   = delegate_ret _actionExports rawf;\n\n// implements BiSubscriber\nClient.prototype.on                     = delegate _subscriber on;\nClient.prototype.once                   = delegate _subscriber once;\nClient.prototype.off                    = delegate _subscriber off;\n\n// implements PluginSystem\nClient.prototype.use                    = delegate     _plugins use;\nClient.prototype.getModule              = delegate_ret _plugins getPlugin;\nClient.prototype.getPlugin              = delegate_ret _plugins getPlugin\nClient.prototype.getRole                = delegate_ret _plugins getRole;\nClient.prototype.initializePlugin       = delegate     _plugins initialize;\nClient.prototype.isPluginInitializable  = delegate_ret _plugins isInitializable;\nClient.prototype.addHook                = delegate     _plugins addHook;\n\n// implements Logger\nClient.prototype.debug                  = delegate _logger debug;\nClient.prototype.info                   = delegate _logger info;\nClient.prototype.note                   = delegate _logger notice;\nClient.prototype.warn                   = delegate _logger warn;\nClient.prototype.error                  = delegate _logger error;\nClient.prototype.crit                   = delegate _logger crit;\nClient.prototype.alert                  = delegate _logger alert;\nClient.prototype.emerg                  = delegate _logger emerg;\n\nClient.prototype.log = function (level) {\n    const args = Array.prototype.slice.call(arguments, 1);\n    this._logger[level].apply(this._logger, args);\n    return this;\n};\n\n// Export the factory.\nmodule.exports = Client;"],"sourceRoot":"/source/"}